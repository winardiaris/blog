---
id: 347
title: Scanning for malware with Linux Malware Detect (LMD)
date: 2017-04-07T22:43:39+00:00
author: winardiaris
layout: post
guid: http://www.winardiaris.xyz/?p=347
permalink: /scanning-malware-linux-malware-detect-lmd/
dsq_thread_id:
  - "5704786513"
image: /wp-content/uploads/2017/04/IMG_20160831_000102.jpg
categories:
  - Catatan
  - Catetan
  - PHP
---
Pekerjaan sebagai _web developer_ khususnya di PHP, tak jarang menemukan situs/web pelanggan yang terserang _backdoors php, darkmailers_ dan banyak fileberbahaya lainnya. Untuk memulihkan situs yang 'sakit' saya sering menggunakan Linux Malware Detect (LMD) atau sering disebut maldet. Kebanyakan situs/web pelanggan di hosting pada shared hosting (cpanel), biasanya saya lakukan pemulihan web yang 'sakit' di mesin lokal (laptop) karena instalasi dan penggunaan maldet membutuhkan akses root.

Cekidot, langsung instal aja.

```bash
$ cd /usr/local/src/
$ wget http://www.rfxn.com/downloads/maldetect-current.tar.gz && tar -xzvf maldetect-current.tar.gz
$ cd maldetect-*
$ chmod +x install.sh
$ ./install.sh
```

Sampai sini maldet telah terpasang pada mesin. Penggunaanya cukup mudah.

Pertama kita perbaharui maldet dan daftar virus

```bash
$ maldet -d && maldet -u
$ maldet -a /var/www/websakit/
```

atau dijalankan di belakang (background)


```bash
$ maldet -b --scan-all /var/www/websakit/
```

melihat semua hasil dan SCANID


```bash
$ maldet --report list
$ maldet --report SCANID
```


atau melihat semua hasil dari log

```bash
$ grep "{scan}" /usr/local/maldetect/event_log
```

karena secara bawaan hasil scan yang terinfeksi tidak dikarantina. untuk mengkarantinanya bisa menggukanan perintah berikut:

```bash
$ maldet -q SCANID
```

Biasanya saya jarang langsung mengkarantinakan berkas yang terinfeksi. Tapi dibersihkan dengan cara menyunting berkas tersebut (untuk berkas `.php`/`.html`) atau mengekspor ulang menggunakan gimp/imagemagick (untuk berkas `.png`/`.jpg`). Lalu di unggah ulang ke hosting.

Salam,